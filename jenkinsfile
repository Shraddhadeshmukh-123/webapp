pipeline {
    agent any

    stages {
        stage('git') {
            steps {
                echo 'Hello World'
                sh "cd /mnt"
                sh "git clone https://github.com/Shraddhadeshmukh-123/webapp.git"
            }
        }
       stage('build') {
       steps {
       sh "cd /mnt"
        sh "mvn clean install" 
        sh "cp /root/.jenkins/workspace/jenkins-file-from-github/target/WebApp.war /mnt"
       }
       }
       stage('deploy')
        {
        steps {
        sshagent(['jenkins-key']) {
       sh """
       cp WebApp.war /mnt/apache-tomcat-9.0.70/webapps
       ssh ec2-user@172.31.43.115 /mnt/apache-tomcat-9.0.70/bin/shutdown.sh
       ssh ec2-user@172.31.43.115 /mnt/apache-tomcat-9.0.70/bin/startup.sh
       """
}
     
     }
        }
}
}
