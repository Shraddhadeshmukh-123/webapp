pipeline {
    agent any

    stages {
        stage('git') {
            steps {
                echo 'Hello World'
                git credentialsId: 'jenkins-key', url: 'https://github.com/Shraddhadeshmukh-123/webapp.git'
            }
        }
       stage('build') {
       steps {
        sh "mvn clean install" 
        sh "mv target/WebApp.war target/myweb.war"
       }
       }
       stage('deploy')
        {
        steps {
        sshagent(['jenkins-key']) {
       sh """
       scp -o ctHostKeyChecking=no target/myweb.war ec2-user@172.31.43.115:/mnt/apache-tomcat-9.0.70/webapps
       shh ec2-user@172.31.43.115 /mnt/apache-tomcat-9.0.70/bin/shutdown.sh
       shh ec2-user@172.31.43.115 /mnt/apache-tomcat-9.0.70/bin/startup.sh
       """
}
     
     }
        }
}
}
